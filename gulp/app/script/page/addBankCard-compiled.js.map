{"version":3,"sources":["addBankCard.js"],"names":[],"mappings":"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","file":"addBankCard-compiled.js","sourcesContent":["/**\n * 手机钱庄\n * @name 绑定银行卡\n * @description 单页js\n * @date 2015-08-12\n */\ndefine(function (require, exports, module) {\n\n    require('zepto');\n    var pageUrl = require('module/ajax-map'),\n        base = require('module/base'),\n        cookie = require('module/cookie'),\n        Mobilebone = require('mobilebone'),\n        activeBtn = require('module/activate-btn'),\n        hrefParameter = require('module/href-parameter'),\n        oneSession = require('module/one-session'),\n        Handlebars = require('module/handlebars-helper');\n\n    //单页js\n    //module.exports = function () {\n    //--------------------------------------------------【绑定银行卡 绑定表单页面 场景切换】\n    base.ajax({\n        url: pageUrl.getUserInfoStatus.url,\n        type: \"post\",\n        data: {\n            oauthToken: cookie.getCookie('qz_h5_oauthToken'),\n            appId: pageUrl.appId,\n            service: pageUrl.getUserInfoStatus.service\n        },\n        dataType: \"json\",\n        async: false,\n        success: function (data) {\n            var bankCardStatus = data.resultData.bankCardStatus;\n            var realNameStatus = data.resultData.realNameStatus;\n            if (bankCardStatus == 1) {//判断是否绑定过银行卡 绑定过跳转我的银行卡页\n                window.location.replace('myBankCard.html');\n                return false;\n            } else if (realNameStatus == 0) {//判断是否实名认证 未认证 链接绑定链接跳转认证页面\n                $('.add-card-link').attr({\n                    'href': 'realName.html',\n                    'data-link': 'true'\n                }).on('click', function () {\n                    oneSession.set('redirectURL', 'index.html#&pageUser');\n                });\n            }\n        }\n    });\n\n    var pageAddBankCard = $('#pageAddBankCard');\n    var pageAddBankCardForm = $('#pageAddBankCardForm');\n    pageAddBankCard.find('.add-card-link').on('click', routeAddBankCardForm);\n    function routeAddBankCardForm() {\n\n        if (eval($(this).attr('data-link')) !== true) {\n            Mobilebone.transition(pageAddBankCardForm[0], pageAddBankCard[0], {\n                history: false\n            });\n        }\n\n    }\n\n    //--------------------------------------------------【表单按钮状态 和 提交跳转】\n    var activebtn = new activeBtn();\n\n    var bandCard = pageAddBankCardForm.find('.js-bandCard');\n    var defBandCardNum = '';\n    var bandCardReg = /^\\d+$/;\n    var isLock = false;\n    bandCard.on('input', checkInput);\n    function checkInput() {\n        var $this = $(this);\n        var _val = $this.val();\n        if (bandCardReg.test(_val)) {\n            defBandCardNum = _val;\n        } else if (_val == '') {\n            defBandCardNum = '';\n        } else {\n            $this.val(defBandCardNum);\n        }\n    }\n\n    pageAddBankCardForm.find('.js-submit').on('click', addBank);\n    function addBank() {\n        if (isLock) {\n            return;\n        }\n        isLock = true;\n        $(this).addClass('disabled').prop('disabled', true);\n\n        var bandCardNum = bandCard.val();\n        if (!bandCardNum) {\n            return;\n        }\n        var encPwdBandCardNum = base.encryptedPwd(bandCardNum);\n        base.ajax({\n            url: pageUrl.addBankCard.url,\n            type: \"post\",\n            data: {\n                appId: pageUrl.appId,\n                service: pageUrl.addBankCard.service,\n                oauthToken: cookie.getCookie('qz_h5_oauthToken'),\n                bankCardNo: encPwdBandCardNum\n            },\n            dataType: \"json\",\n            async: false,\n            success: function (data) {\n                var pennyUrl = pageUrl.pennyBindingCard.url;\n                pennyUrl += '?appId=' + pageUrl.appId;\n                pennyUrl += '&bankCardNo=' + encPwdBandCardNum;\n                pennyUrl += '&oauthToken=' + cookie.getCookie('qz_h5_oauthToken');\n                pennyUrl += '&service=' + pageUrl.pennyBindingCard.service;\n                window.location.replace(pennyUrl);\n            },\n            beforeFunc: function () {\n                isLock = false;\n                $(this).removeClass('disabled').prop('disabled', false);\n            }\n        });\n    }\n\n    Mobilebone.classAnimation = \"fade\";\n    Mobilebone.init();\n    //--------------------------------------------------【暴露接口内存回收】\n    //return function () {\n    //    pageAddBankCard.find('.add-card-link').off('click', routeAddBankCardForm);\n    //    bandCard.off('input', checkInput);\n    //    pageAddBankCardForm.find('.js-submit').off('click', addBank);\n    //};\n    //};\n});\n"]}