{"version":3,"sources":["loginCheck.js"],"names":[],"mappings":"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","file":"loginCheck-compiled.js","sourcesContent":["/**\n * 手机钱庄\n * @name 登录前校验跳转登录or注册\n * @description 单页js\n * @date 2015-07-16\n */\ndefine(function (require, exports, module) {\n\n    require('zepto');\n    var pageUrl = require('module/ajax-map'),\n        Pop = require('module/dialog'),\n        base=require('module/base'),\n        Mobilebone = require('mobilebone'),\n        Verifyfrom = require('module/verifyfrom'),\n        verifyRule = require('module/validate-rule'),\n        verifyTips = require('module/validate-tips'),\n        ActivateBtn=require('module/activate-btn'),\n        SubmitIng = require('module/submit-ing'),\n        oneSession = require('module/one-session');\n\n    module.exports = function () {\n        var $pageLoginCheck = $('#pageLoginCheck'),\n            alertPop = new Pop('alert');\n\n        //--------------------------------------------------【手机号只能输入数字】\n        var $userPhone=$('#userPhone');\n\n        $userPhone.on('input change',function(){\n            var $this=$(this);\n            $this.val($this.val().replace(/\\D/g,''));\n        });\n        //--------------------------------------------------【激活按钮】\n        var activateBtn=new ActivateBtn({\n            contain:$pageLoginCheck[0]\n        });\n\n        //--------------------------------------------------【表单校验】\n        var verifyfrom = new Verifyfrom();\n\n        verifyfrom.add($userPhone[0], [{\n            strategy: verifyRule.phone,\n            errorMsg: verifyTips.USER_REGISTER_PHONE_FORMAT_ERROR\n        }]);\n\n        // 防重复提交\n        var submitIng = new SubmitIng({\n            elmBtn: $pageLoginCheck.find('.js-submit')[0]\n        });\n        $pageLoginCheck.find('.js-submit').on('click', function () {\n\n            var userPhoneVal = $userPhone.val(),\n                errorMsg = verifyfrom.start();    // 运行校验模块,获得错误信息(如果有错误的话)\n\n            // 提交中则跳出\n            if (submitIng.state) {\n                return false\n            } else {\n                submitIng.start('提交中...');\n            }\n\n            // 显示错误提示,跳出submit\n            if (errorMsg) {\n                alertPop.run(errorMsg);\n                submitIng.end();\n                return false;\n            }\n\n            base.ajax({\n                url: pageUrl.phoneCheck.url,\n                type: \"post\",\n                data: {\n                    'userName': base.encryptedPwd(userPhoneVal),\n                    'appId': pageUrl.appId,\n                    'service': pageUrl.phoneCheck.service\n                },\n                dataType: \"json\",\n                success: function (data) {\n                    if (data.resultCode == 0) {\n                        alertPop.run(data.resultMsg);\n                        return false;\n                    }\n                    oneSession.set('userPhone',userPhoneVal);\n                    if (data.resultData.phoneExist == 0) {\n                        Mobilebone.transition($('#pageSignIn')[0], $('#pageLoginCheck')[0]);\n                        return false;\n                    }\n                    if (data.resultData.phoneExist == 1) {\n                        Mobilebone.transition($('#pageLogin')[0], $('#pageLoginCheck')[0]);\n                        return false;\n                    }\n                },\n                timeout: 10000,\n                error: function () {\n                    alertPop.run('请求超时请重新再试');\n                },\n                beforeFunc:function(){\n                    submitIng.end();\n                }\n            });\n\n        });\n        //--------------------------------------------------【暴露接口内存回收】\n        return function () {\n            $pageLoginCheck.find('.js-submit').off('click');\n            activateBtn.destroy();\n            alertPop.destroy();\n            verifyfrom.destroy();\n            submitIng.destroy();\n        }\n    };\n});"]}