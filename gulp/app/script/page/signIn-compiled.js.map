{"version":3,"sources":["signIn.js"],"names":[],"mappings":"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","file":"signIn-compiled.js","sourcesContent":["/**\n * 手机钱庄\n * @name 注册页\n * @description 单页js\n * @date 2015-07-28\n */\ndefine(function (require, exports, module) {\n    require('zepto');\n\n    var pageUrl = require('module/ajax-map'),\n        Pop = require('module/dialog'),\n        base = require('module/base'),\n        Verifyfrom = require('module/verifyfrom'),\n        ActivateBtn = require('module/activate-btn'),\n        cookie = require('module/cookie'),\n        verifyRule = require('module/validate-rule'),\n        verifyTips = require('module/validate-tips'),\n        VerifyCode = require('module/verifyCode'),\n        SubmitIng = require('module/submit-ing'),\n        oneSession = require('module/one-session');\n\n    module.exports = function () {\n        var $pageSignIn = $('#pageSignIn'),\n            alertPop = new Pop('alert'),\n            confirmPop = new Pop('confirm');\n\n        //--------------------------------------------------【激活按钮】\n        var activateBtn = new ActivateBtn({\n            contain: $pageSignIn[0]\n        });\n\n        //--------------------------------------------------【点注册协议添加session,防止页面返回后检测无userPhone,跳转到注册的第一步去】\n        $pageSignIn.find('.protocol a').on('click', function () {\n            oneSession.set('userPhone', $pageSignIn.find('.js-userPhone').val());\n        });\n\n        //--------------------------------------------------【表单校验】\n        var verifyfrom = new Verifyfrom();\n\n        // 格式校验\n        verifyfrom.add($('#setPassword')[0], [{\n            strategy: verifyRule.loginPasswordLengthMin,\n            errorMsg: verifyTips.USER_REGISTER_PASSWORD_FORMAT_ERROR\n        }, {\n            strategy: verifyRule.loginPasswordLengthMax,\n            errorMsg: verifyTips.USER_REGISTER_PASSWORD_FORMAT_ERROR\n        }]);\n\n        // 发送验证码\n        var verifyCode = new VerifyCode({\n            elmInput: $pageSignIn.find('.js-userPhone')[0],\n            elmBtn: $('#verifyCodeBtn')[0],\n            url: pageUrl.validCode.url,\n            isInstant: true,\n            data: {\n                'userName': $pageSignIn.find('.js-userPhone').val(),\n                'appId': pageUrl.appId,\n                'service': pageUrl.validCode.service\n            },\n            timeStartCallback: function () {\n                $('#voiceTips').addClass('js_hide');\n            },\n            timeEndCallback: function () {\n                $('#voiceTips').removeClass('js_hide');\n            }\n        });\n\n        // 防重复提交\n        var submitIng = new SubmitIng({\n            elmBtn: $pageSignIn.find('.js-submit')[0]\n        });\n\n        // 表单提交\n        $pageSignIn.find('.js-submit').on('click', function () {\n            var userPhoneVal = $pageSignIn.find('.js-userPhone').val(),\n                passwordVal = $('#setPassword').val(),\n                validCodeVal = $('#verifyCode').val(),\n                errorMsg = verifyfrom.start();\n\n            // 提交中则跳出\n            if (submitIng.state) {\n                return false\n            } else {\n                submitIng.start('提交中...');\n            }\n\n            // 显示错误提示,跳出submit\n            if (errorMsg) {\n                submitIng.end();\n                alertPop.run(errorMsg);\n                return false;\n            }\n\n            base.ajax({\n                url: pageUrl.register.url,\n                type: \"post\",\n                data: {\n                    'userName': base.encryptedPwd(userPhoneVal),\n                    'pwd': base.encryptedPwd(passwordVal),\n                    'phoneCode': validCodeVal,\n                    'appId': pageUrl.appId,\n                    'service': pageUrl.register.service\n                },\n                dataType: \"json\",\n                success: function (data) {\n                    if (data.resultCode == 0) {\n                        alertPop.run(data.resultMsg);\n                        return false;\n                    }\n\n                    var redirectURL = oneSession.get('redirectURL');\n                    if (redirectURL) {\n                        window.location.href = redirectURL;\n                    } else {\n                        window.location.href = 'index.html';\n                    }\n\n                },\n                timeout: 10000,\n                error: function () {\n                    alertPop.run('请求超时请重新再试');\n                },\n                beforeFunc: function () {\n                    submitIng.end();\n                }\n            });\n        });\n\n        //--------------------------------------------------【提示语音验证】\n        $('#voiceBtn').on('click', function () {\n            confirmPop.run({\n                titStr: '',\n                contStr: '验证码将以语音电话的形式呼到您的手机,请注意接听400-0455-360的来电.',\n                confirmFunc: function () {\n                    $.ajax({\n                        url: pageUrl.regVoiceCode.url,\n                        data: {\n                            'userName': base.encryptedPwd($pageSignIn.find('.js-userPhone').val()),\n                            'appId': pageUrl.appId,\n                            'service': pageUrl.regVoiceCode.service\n                        },\n                        dataType: 'json',\n                        type: 'post',\n                        beforeSend: function () {\n                            $('#verifyCodeBtn')[0].setAttribute('disabled', true);\n                        },\n                        success: function (data) {\n                            cookie.setCookie('verifyCodeTime', 60, 60);\n                            verifyCode._timeUpdate();\n                        }\n                    });\n                }\n            });\n        });\n        //--------------------------------------------------【暴露接口内存回收】\n        return function () {\n            $pageSignIn.find('.js-submit').off('click');\n            activateBtn.destroy();\n            alertPop.destroy();\n            verifyfrom.destroy();\n            verifyCode.destroy();\n            submitIng.destroy();\n        }\n    };\n});"]}