{"version":3,"sources":["buyAffirm.js"],"names":[],"mappings":"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","file":"buyAffirm-compiled.js","sourcesContent":["/**\n * 手机钱庄\n * @name 申购确认页\n * @description 单页js\n * @date 2015-07-30\n */\ndefine(function (require, exports, module) {\n\n    require('zepto');\n    var pageUrl = require('module/ajax-map'),\n        base = require('module/base'),\n        Dialog = require('module/dialog'),\n        cookie = require('module/cookie'),\n        hrefParameter = require('module/href-parameter'),\n        oneSession = require('module/one-session'),\n        SubmitIng = require('module/submit-ing'),\n        ActivateBtn = require('module/activate-btn');\n\n    module.exports = function () {\n        var $pageProBuy = $('#pageProBuy');\n        var popAlert = new Dialog('alert');\n        //--------------------------------------------------【按钮激活】\n        var activateBtn = new ActivateBtn({\n            contain: $pageProBuy[0]\n        });\n        //--------------------------------------------------【申购数据联动】\n        var $buyAmount = $('#buyAmount'),\n            $earnings = $('#earnings'),\n            $envelopeBtn = $('#envelopeBtn'),\n            $envelopeList = $('#envelopeList'),\n            $investAmount = $('#investAmount'),\n            $bankBuy = $('#bankBuy'),\n            lowestAccountVal = Number($('#lowestAccount').val()), //最小投资额\n            importAmount = 0,   // 输入的金额\n            redPacketTotal = 0,  //勾选红包总和\n            redPacketLimit = 0, //最大可选红包金额\n            redPacketIdArr = [],  //红包id列表\n            tenderDayVal = $('#tenderDay').val(), // 实际投资天数\n            balanceVal = parseInt($('#balance').html()),    // 账户可用余额\n            aprVal = Number($('#normalApr').val()) + Number($('#extraAwardApr').val()), // 最终年化收益\n            mostAccount = Number($('#mostAccount').val()), // 最大投资金额\n            buyAmount = 0,   // 余额支付金额\n            bankBuyAmount = 0,   // 银行卡支付\n\n            // 计算实际需支付金额\n            buyAmountFunc = function () {\n                if (importAmount <= balanceVal + redPacketTotal) {\n                    buyAmount = importAmount - redPacketTotal;\n                    $buyAmount.html(buyAmount);\n                    $bankBuy.html(0);\n                } else {\n                    buyAmount = balanceVal;\n                    bankBuyAmount = importAmount - balanceVal - redPacketTotal;\n                    $buyAmount.html(buyAmount);\n                    $bankBuy.html(bankBuyAmount.toFixed(2));\n                }\n            };\n\n        // 显示红包列表\n        $envelopeBtn.one('click', function () {\n            $envelopeList.removeClass('js_hide');\n            $envelopeBtn.find('.conts').addClass('font-color-red').html('已选择0元');\n        });\n\n        // 勾选红包\n        $envelopeList.find('input').on('change', function () {\n            var $this = $(this);\n\n            // 如果未输入投资金额,提示\n            if (!$investAmount.val()) {\n                $this[0].checked = false;\n                redPacketTotal -= $this.data('amount');\n                popAlert.run('请输入投资金额');\n                return false;\n            }\n\n            // 产品可投金额小于最小投资额时(即将满标状态)不可使用红包\n            if (mostAccount < lowestAccountVal) {\n                popAlert.run('本次最多可用0元红包');\n            }\n\n            // 根据是否勾选计算红包总和\n            if ($this[0].checked) {\n                redPacketTotal += $this.data('amount');\n                // 存入红包id\n                redPacketIdArr.push($this.val());\n            } else {\n                redPacketTotal -= $this.data('amount');\n                redPacketIdArr.forEach(function (val, index) {\n                    if (val == $this.val()) {\n                        redPacketIdArr.splice(index, 1);\n                    }\n                });\n\n            }\n\n            // 超过最大可选红包金额时取消勾选,并提示\n            if (redPacketTotal > redPacketLimit) {\n                $this[0].checked = false;\n                redPacketTotal -= $this.data('amount');\n                redPacketIdArr.pop();\n                popAlert.run('本次最多可用' + redPacketLimit + '元红包');\n            }\n\n            // 已选择红包金额显示\n            $envelopeBtn.find('.conts').html('已选择' + redPacketTotal + '元');\n\n            buyAmountFunc();\n        });\n\n        // 预估收益计算\n        $investAmount.on('input', function () {\n            var $this = $(this);\n\n            importAmount = Number($this.val().replace(/\\D/g, ''));\n\n            // 重置红包列表\n            $envelopeBtn.find('input').each(function () {\n                this.checked = false;\n            });\n\n            if (!$envelopeList.hasClass('js_hide')) {\n                $envelopeBtn.find('.conts').html('已选择0元');\n            }\n            redPacketIdArr.length = 0;\n\n            // 重置勾选的红包总计\n            redPacketTotal = 0;\n\n            // 禁止输入非数字\n            $this.val(importAmount);\n\n            // 超过最大投资金额,则替换成最大投资金额\n            if (importAmount > mostAccount) {\n                importAmount = mostAccount;\n                $this.val(mostAccount);\n            }\n\n            // 计算逾期收益\n            $earnings.html(((importAmount * aprVal * 0.01) / 365 * tenderDayVal).toFixed(2));\n\n            // 最大可选红包金额\n            redPacketLimit = parseInt(importAmount * 0.05);\n\n            // 投资金额大于最低可投,显示红包可用大小\n            if (mostAccount >= lowestAccountVal && importAmount >= lowestAccountVal) {\n                $('#redPacketLimit').html('红包(本次可用' + parseInt(redPacketLimit) + '元)');\n            } else {\n                $('#redPacketLimit').html('红包(本次可用0元)');\n            }\n\n            // 重置红包列表\n            $envelopeList.find('input').each(function () {\n                this.checked = false;\n            });\n\n            buyAmountFunc();\n        });\n\n        // 需要一次性投资完的情况\n        if ($investAmount.val()) {\n            $investAmount.trigger('input');\n        }\n        //--------------------------------------------------【绑卡流程】\n        var $bankCard = $('#bankCard');\n        $('#bindBank').on('change', function () {\n            var $this = $(this);\n            $('#bankCardNo').val('');\n            if ($this.val()) {\n                $bankCard.removeClass('js_hide');\n            } else {\n                $bankCard.addClass('js_hide');\n            }\n        });\n        $('#bankCardNo').on('input',function(){\n            var $this=$(this);\n            $this.val($this.val().replace(/\\D/g,''));\n        });\n        //--------------------------------------------------【表单提交】\n\n        var popDealPassword = new Dialog('confirm'),\n            htmlStr = '';\n\n\n        // 防重复提交\n        var submitIng = new SubmitIng({\n            elmBtn: $pageProBuy.find('.js-submit')[0]\n        });\n\n        $pageProBuy.find('.js-submit').on('click', function () {\n            var dealPasswordVal = '',   // 获取交易密码\n                bankCardNoVal = $('#bankCardNo').val(),   // 获取银行卡卡号\n                buyType = $bankBuy.html() == '0' ? 0 : 1, // 根据dom上的余额标签显示判断支付类别,0为余额支付,1为跳转连连支付\n                isBindBank = $('#hiddenCardNo').html() ? 1 : 0;   //根据dom上的是否有银行卡尾号标签,判断是否绑定银行卡\n\n            // 提交中则跳出\n            if (submitIng.state) {\n                return false\n            } else {\n                submitIng.start('支付中...');\n            }\n\n            if (mostAccount > lowestAccountVal) {\n                if (lowestAccountVal > importAmount) {\n                    popAlert.run('投资金额不能少于起投金额');\n                    submitIng.end();\n                    return false;\n                }\n            }\n\n            htmlStr = '<div class=\"ui-pop-cont-deal-password\"><input id=\"dealPassword\" class=\"ui-input-text\" type=\"password\" /><a class=\"font-color-gray-neutral\" href=\"forgetTransPassword.html\" data-ajax=\"false\">忘记</a></div>';\n            popDealPassword.run({\n                titStr: '请输入交易密码',\n                contStr: htmlStr,\n                confirmFunc: function () {\n                    dealPasswordVal = $('#dealPassword').val();\n                    if (!dealPasswordVal) {\n                        popAlert.run('请输入交易密码');\n                        submitIng.end();\n                        return false;\n                    }\n                    if (!buyType) {\n                        base.ajax({\n                            type: \"post\",\n                            url: pageUrl.tender.url,\n                            async: true,\n                            dataType: \"json\",\n                            data: {\n                                appId: pageUrl.appId,\n                                borrowId: hrefParameter.get('borrowId'),\n                                money: importAmount,\n                                oauthToken: cookie.getCookie('qz_h5_oauthToken'),\n                                payPwd: base.encryptedPwd(dealPasswordVal),\n                                redpacketIds: redPacketIdArr.join(','),\n                                service: pageUrl.tender.service,\n                                useMoney: buyAmount\n                            },\n                            success: function (data) {\n                                location.href = hrefParameter.create(location.href.split('#')[0]).set('orderNo', data.resultData.orderNo) + '#&pageBuyResult';\n                            },\n                            beforeFunc: function () {\n                                submitIng.end();\n                            }\n                        });\n                    } else {\n                        if (!isBindBank) {\n                            base.ajax({\n                                type: \"post\",\n                                url: pageUrl.addBankCard.url,\n                                async: true,\n                                dataType: \"json\",\n                                data: {\n                                    appId: pageUrl.appId,\n                                    service: pageUrl.addBankCard.service,\n                                    bankCardNo: base.encryptedPwd(bankCardNoVal),\n                                    oauthToken: cookie.getCookie('qz_h5_oauthToken')\n                                },\n                                success: function (data) {\n                                    if (data.resultCode == 1) {\n                                        checkTenderForCard(dealPasswordVal, base.encryptedPwd(bankCardNoVal));\n                                    }\n                                },\n                                beforeFunc: function () {\n                                    submitIng.end();\n                                }\n                            });\n                            return false;\n                        }\n                        checkTenderForCard(dealPasswordVal, base.encryptedPwd(bankCardNoVal));\n                    }\n                },\n                cancelFunc: function () {\n                    // 取消回调\n                    submitIng.end();\n                },\n                callback: function () {\n                    // 添加session做页面返回的重定向\n                    $('#uiPopFrame .ui-pop-cont-deal-password a').on('click', function () {\n                        oneSession.set('redirectURL', location.href);\n                    });\n\n                    // 交易密码输入框获得焦点\n                    $('#dealPassword').focus();\n                }\n            });\n        });\n        function checkTenderForCard(dealPasswordVal, bankCardNoVal) {\n            base.ajax({\n                type: \"post\",\n                url: pageUrl.checkTenderForCard.url,\n                async: true,\n                dataType: \"json\",\n                data: {\n                    appId: pageUrl.appId,\n                    bankCardNo: bankCardNoVal,\n                    bankMoney: bankBuyAmount,\n                    borrowId: hrefParameter.get('borrowId'),\n                    money: importAmount,\n                    oauthToken: cookie.getCookie('qz_h5_oauthToken'),\n                    payPwd: base.encryptedPwd(dealPasswordVal),\n                    redpacketIds: redPacketIdArr.join(','),\n                    service: pageUrl.checkTenderForCard.service,\n                    useMoney: buyAmount\n                },\n                success: function (data) {\n                    var newData = $.extend(this.data, {\n                        service: pageUrl.tenderForCard.service\n                    });\n\n                    location.href = pageUrl.tenderForCard.url + '?' + $.param(newData);\n                },\n                beforeFunc: function () {\n                    submitIng.end();\n                }\n            });\n        }\n\n        //--------------------------------------------------【暴露接口内存回收】\n        return function () {\n\n            $envelopeBtn.off('click');\n            $envelopeList.find('input').off('change');\n            $investAmount.off('input');\n            $('#bindBank').off('change');\n            $pageProBuy.find('.js-submit').off('click');\n\n            popAlert.destroy();\n            activateBtn.destroy();\n            popDealPassword.destroy();\n            submitIng.destroy();\n        }\n    };\n});"]}