{"version":3,"sources":["proLogin.js"],"names":[],"mappings":"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","file":"proLogin-compiled.js","sourcesContent":["/**\n * 手机钱庄\n * @name 产品内页登录页\n * @description 单页js\n * @date 2015-08-13\n */\ndefine(function (require, exports, module) {\n\n    require('zepto');\n    var pageUrl = require('module/ajax-map'),\n        base = require('module/base'),\n        Pop = require('module/dialog'),\n        Verifyfrom = require('module/verifyfrom'),\n        verifyRule = require('module/validate-rule'),\n        verifyTips = require('module/validate-tips'),\n        cookie = require('module/cookie'),\n        ActivateBtn = require('module/activate-btn'),\n        SubmitIng = require('module/submit-ing'),\n        oneSession = require('module/one-session');\n\n    module.exports = function () {\n        var $pageLogin = $('#pageLogin'),\n            alertPop = new Pop('alert');\n\n        //--------------------------------------------------【激活按钮】\n        var activateBtn = new ActivateBtn({\n            contain: $pageLogin[0]\n        });\n\n        //--------------------------------------------------【点击忘记密码存手机号到session中】\n        $('#forgetLoginPasswordBtn').on('click',function(){\n            oneSession.set('userPhone',$pageLogin.find('.js-userPhone').val());\n            oneSession.set('redirectURL', window.location.href);\n        });\n        //--------------------------------------------------【表单校验】\n        var verifyfrom = new Verifyfrom();\n\n        verifyfrom.add($('#loginPassword')[0], [{\n            strategy: verifyRule.loginPasswordLengthMin,\n            errorMsg: verifyTips.USER_REGISTER_PASSWORD_FORMAT_ERROR\n        }, {\n            strategy: verifyRule.loginPasswordLengthMax,\n            errorMsg: verifyTips.USER_REGISTER_PASSWORD_FORMAT_ERROR\n        }]);\n\n        // 防重复提交\n        var submitIng = new SubmitIng({\n            elmBtn: $pageLogin.find('.js-submit')[0]\n        });\n        $pageLogin.find('.js-submit').on('click', function () {\n            var userPhoneVal = $pageLogin.find('.js-userPhone').val(),\n                passwordVal = $('#loginPassword').val(),\n                errorMsg = verifyfrom.start();    // 运行校验模块,获得错误信息(如果有错误的话)\n\n            // 提交中则跳出\n            if (submitIng.state) {\n                return false\n            } else {\n                submitIng.start('提交中...');\n            }\n\n            // 显示错误提示,跳出submit\n            if (errorMsg) {\n                submitIng.end();\n                alertPop.run(errorMsg);\n                return false;\n            }\n\n            base.ajax({\n                url: pageUrl.login.url,\n                type: \"post\",\n                xhrFields: {\n                    withCredentials: true\n                },\n                data: {\n                    'userName': base.encryptedPwd(userPhoneVal),\n                    'pwd': base.encryptedPwd(passwordVal),\n                    'appId': pageUrl.appId,\n                    'service': pageUrl.login.service\n                },\n                async:false,\n                dataType: \"json\",\n                success: function (data) {\n                    if (data.resultCode == 0) {\n                        alertPop.run(data.resultMsg);\n                        return false;\n                    }\n\n                    window.location.reload();\n                },\n                timeout: 10000,\n                error: function () {\n                    alertPop.run('请求超时请重新再试');\n                },\n                beforeFunc:function(){\n                    submitIng.end();\n                }\n            });\n        });\n        //--------------------------------------------------【暴露接口内存回收】\n        return function () {\n            $pageLogin.find('.js-submit').off('click');\n            activateBtn.destroy();\n            alertPop.destroy();\n            verifyfrom.destroy();\n            submitIng.destroy();\n        }\n    };\n});"]}