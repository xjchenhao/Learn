{"version":3,"sources":["forgetLoginPassword.js"],"names":[],"mappings":"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","file":"forgetLoginPassword-compiled.js","sourcesContent":["/**\n * 手机钱庄\n * @name 忘记登录密码\n * @description 单页js\n * @date 2015-08-05\n */\ndefine(function (require, exports, module) {\n\n    require('zepto');\n    var pageUrl = require('module/ajax-map'),\n        base = require('module/base'),\n        cookie = require('module/cookie'),\n        Pop = require('module/dialog'),\n        Verifyfrom = require('module/verifyfrom'),\n        verifyRule = require('module/validate-rule'),\n        verifyTips = require('module/validate-tips'),\n        VerifyCode = require('module/verifyCode'),\n        ActivateBtn = require('module/activate-btn'),\n        SubmitIng = require('module/submit-ing'),\n        oneSession = require('module/one-session');\n\n    // 这里没有做路由,而是直接在页面js上载入数据,所以不需要暴露模块接口给路由js调用\n    //module.exports = function () {\n\n    var $pageLoginTransPassword = $('#pageLoginTransPassword'),\n        $submitBtn = $('#submitBtn'),\n        $userPhone = $('#userPhone');\n    //--------------------------------------------------【验证码获取】\n\n    // 发送验证码\n    var verifyCode = new VerifyCode({\n        elmInput: $userPhone[0],\n        elmBtn: $('#verifyCodeBtn')[0],\n        url: pageUrl.forgetPwdGetValCode.url,\n        phoneKey: 'userName',\n        data: {\n            'appId': pageUrl.appId,\n            'service': pageUrl.forgetPwdGetValCode.service\n        }\n    });\n\n    //--------------------------------------------------【自动填入传值手机号】\n    var forgetPwdPhoneVal=oneSession.get('userPhone');\n    if(forgetPwdPhoneVal){\n        $userPhone.val(forgetPwdPhoneVal);\n        verifyCode.run();\n    }\n\n    //--------------------------------------------------【激活按钮】\n    var activateBtn = new ActivateBtn({\n        contain: $pageLoginTransPassword[0]\n    });\n    //--------------------------------------------------【格式校验】\n    var verifyfrom = new Verifyfrom(),\n        alertPop = new Pop('alert');\n\n    // 校验规则\n    verifyfrom.add($('#password')[0], [{\n        strategy: verifyRule.loginPasswordLengthMin,\n        errorMsg: verifyTips.USER_REGISTER_PASSWORD_FORMAT_ERROR\n    }, {\n        strategy: verifyRule.loginPasswordLengthMax,\n        errorMsg: verifyTips.USER_REGISTER_PASSWORD_FORMAT_ERROR\n    }]);\n\n\n    //--------------------------------------------------【表单提交】\n\n    // 防重复提交\n    var submitIng = new SubmitIng({\n        elmBtn: $submitBtn[0]\n    });\n\n    $submitBtn.on('click', function () {\n        var passwordVal = $('#password').val(),\n            verifyCodeVal = $('#verifyCode').val(),\n            userPhoneVal = $userPhone.val(),\n            errorMsg = verifyfrom.start();    // 运行校验模块,获得错误信息(如果有错误的话)\n\n        // 提交中则跳出\n        if (submitIng.state) {\n            return false\n        } else {\n            submitIng.start('提交中...');\n        }\n\n        // 显示错误提示,跳出submit\n        if (errorMsg) {\n            submitIng.end();\n            alertPop.run(errorMsg);\n            return false;\n        }\n\n        base.ajax({\n            url: pageUrl.resetLoginPwd.url,\n            type: \"post\",\n            data: {\n                appId: pageUrl.appId,\n                service: pageUrl.resetLoginPwd.service,\n                pwd: base.encryptedPwd(passwordVal),\n                phoneCode: verifyCodeVal,\n                userName: base.encryptedPwd(userPhoneVal)\n            },\n            dataType: \"json\",\n            async: false,\n            success: function (data) {\n                alertPop.run({\n                    contStr: '登录密码重置成功',\n                    confirmFunc: function () {\n                        oneSession.set('userPhone',userPhoneVal);\n                        window.location.href = 'login.html#&pageLogin'\n                    }\n                });\n            },\n            timeout: 10000,\n            error: function () {\n                alertPop.run('请求超时请重新再试');\n            },\n            beforeFunc: function () {\n                submitIng.end();\n            }\n        });\n    });\n    //--------------------------------------------------【暴露接口内存回收】\n    return function () {\n        submitIng.destroy();\n\n    };\n    //};\n});"]}