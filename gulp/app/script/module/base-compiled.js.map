{"version":3,"sources":["base.js"],"names":[],"mappings":"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","file":"base-compiled.js","sourcesContent":["/**\n * 钱庄网\n * @name 基础js\n * @description 整站基础js模块\n * @date 2015-07-16\n * @version $V1.0$\n */\ndefine(function (require, exports, module) {\n    require('zepto');\n    require('fastclick');\n\n    var cookie = require('module/cookie'),\n        pageUrl = require('module/ajax-map'),\n        Dialog = require('module/dialog'),\n        rsaEncrypt = require('module/rsaEncrypt'),\n        oneSession = require('module/one-session');\n\n    var popAlert = new Dialog('alert');\n    //--------------------------------------------------【ajax代理】\n    var ajaxAgent = function (arg) {\n        var _loginLink = \"login.html\",\n            reg = new RegExp(\"(http|https)://\" + location.host + \"/\"),\n            _currentLink = location.href.replace(reg, \"\"),\n            beforeFunc = arg.beforeFunc;\n\n        return $.ajax({\n            type: arg.type || \"post\",\n            url: arg.url,\n            async: arg.async && !0,\n            dataType: arg.dataType || \"json\",\n            data: arg.data,\n            xhrFields: {\n                withCredentials: true\n            },\n            success: function (data) {\n                beforeFunc && beforeFunc();\n                if (data.resultCode == 0) {\n                    if (data.errorCode == 'TOKEN_EXPIRED') {\n                        // 弹出提醒\n                        popAlert.run({\n                            contStr: data.resultMsg,\n                            confirmFunc: function () {\n                                oneSession.set('redirectURL', 'index.html#&pageUser');\n                                window.location.href = _loginLink + \"?\" + encodeURIComponent(\"redirectURL=index.html#&pageUser\");\n                            }\n                        });\n\n                        // 删除登录标识cookie\n                        cookie.setCookie('qz_h5_phone', '', -1);\n                        cookie.setCookie('qz_h5_oauthToken', '', -1);\n                    } else {\n\n                        // 弹出提醒\n                        popAlert.run({\n                            contStr: data.resultMsg\n                        });\n                    }\n                    return false;\n                }\n                arg.success && arg.success(data);\n            },\n            timeout: 10000,\n            error: function (obj, errMsg, error) {\n                beforeFunc && beforeFunc();\n                arg.errMsg && arg.errMsg(data);\n                \"function\" == typeof arg.error ? arg.error() : console.log(errMsg)\n            }\n        })\n    };\n    //--------------------------------------------------【请求加密】\n\n    var encryptedPwd = rsaEncrypt('10001', '9d183e5918a188d09ead235a4c2dc54e5216281d4a72fa57d21cf736d445d60591ba794c201efcf3f98bb3553a314f84d6b4af92dd400da34c2d9ad65baca2e7b329bf5320fa2e5790f91ab79a492d0b75ce1a6fa60dc8ab5399dd7e61632284e42aee9b33596b06ee2c256d0ef819e6f64378d33d0d9cfd5fa4462880e1ebd9');\n\n    //--------------------------------------------------【加载完成,隐藏加载遮罩】\n    $(window).on('load', function () {\n        $('#pageLoading').remove();\n    });\n\n    //--------------------------------------------------【全局bug修复】\n\n    // 解决在微信上a标签:active伪类失效的bug\n    window.addEventListener('touchstart', function () {\n    }, false);\n\n    // fastclick代替zepto的tap,防止点透bug\n    window.addEventListener('load', function () {\n        //FastClick.attach(document.body);\n    }, false);\n\n    //--------------------------------------------------【判断登陆】\n\n    // 根据cookie前端层面简单的登录与否判断\n    var isLogin = function () {\n        var loginStart = false;\n        if (cookie.getCookie('qz_h5_phone') && cookie.getCookie('qz_h5_oauthToken')) {\n            $.ajax({\n                url: pageUrl.getUserInfoStatus.url,\n                type: \"post\",\n                data: {\n                    oauthToken: cookie.getCookie('qz_h5_oauthToken'),\n                    appId: pageUrl.appId,\n                    service: pageUrl.getUserInfoStatus.service\n                },\n                xhrFields: {\n                    withCredentials: true\n                },\n                dataType: \"json\",\n                async: false,\n                success: function (data) {\n                    if (data.resultCode !== 1) {\n                        loginStart = false;\n                    } else {\n                        loginStart = true;\n                    }\n                }\n            });\n        } else {\n            loginStart = false;\n        }\n        return loginStart;\n    };\n\n    // 给mobilebone页面跳转的a标签绑定的-是否登录校验。\n    window.isLoginPrevent = function (target) {\n        var isPreventLogin = true,\n            regUrlFormat = /^#.*/,\n            redirectURL = '';\n\n        if (cookie.getCookie('qz_h5_phone') && cookie.getCookie('qz_h5_oauthToken')) {\n            isPreventLogin = false;\n        } else {\n            redirectURL = target.getAttribute('href');\n\n            if (redirectURL == 'javascript:;' || redirectURL == '#') {\n                redirectURL = location.href;\n            }\n\n            if (regUrlFormat.test(redirectURL)) {\n                redirectURL = location.href.split('#')[0] + redirectURL;\n            }\n\n            oneSession.set('redirectURL', redirectURL);\n            location.href = 'login.html';\n            isPreventLogin = true;\n        }\n\n        return isPreventLogin;\n    };\n\n    //--------------------------------------------------【暴露公共方法】\n    module.exports = {\n        ajax: ajaxAgent,\n        isLogin: isLogin,\n        encryptedPwd: encryptedPwd\n    }\n});"]}