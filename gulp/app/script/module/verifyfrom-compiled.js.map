{"version":3,"sources":["verifyfrom.js"],"names":[],"mappings":"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","file":"verifyfrom-compiled.js","sourcesContent":["/* 表单验证    2.1.3*/\n\n(function (root, factory) {\n    if (typeof define === 'function' && (define.amd || define.cmd)) {\n        define(function (exports) {\n            return factory(root, exports);\n        });\n    } else {\n        root.Verifyfrom = factory(root, {});\n    }\n})(this, function (root, Verifyfrom) {\n\n    /*********************** 策略对象 ***********************/\n    var strategies = {\n            isNonEmpty: function (value, errorMsg) {\n                if (value === '') {\n                    failure && failure(this, errorMsg);\n                    return errorMsg;\n                }\n                succeed && succeed(this);\n            },\n            minLength: function (value, length, errorMsg) {\n                if (value.length < length) {\n                    failure && failure(this, errorMsg);\n                    return errorMsg;\n                }\n                succeed && succeed(this);\n            },\n            maxLength: function (value, length, errorMsg) {\n                if (value.length > length) {\n                    failure && failure(this, errorMsg);\n                    return errorMsg;\n                }\n                succeed && succeed(this);\n            },\n            isReg: function (value, reg, errorMsg) {\n                var reg = new RegExp(reg);\n                if (!reg.test(value)) {\n                    failure && failure(this, errorMsg);\n                    return errorMsg;\n                }\n                succeed && succeed(this);\n            },\n            serverVerify: function (value, requestFunc) {\n                var errorMsg = requestFunc(value);\n                if (errorMsg) {\n                    failure && failure(this, errorMsg);\n                    return errorMsg;\n                }\n                succeed && succeed(this);\n            }\n        },\n        verifyStart = true, // 触发表单校验start方法的模拟blur事件时,遇到错误就关闭校验状态,阻止进行后面的校验\n        eventFunc = [],   // blur事件的方法栈\n        succeed = null, // 表单元素校验成功回调函数,函数有一个回调参数,即校验成功的表单元素\n        failure = null; // 表单元素校验失败回调函数,函数有两个回调参数,第一个是校验失败的表单元素,第二个是错误的描述文字\n\n    var Validator = function (obj) {\n        var obj = obj || {};\n        this.domCache = [];\n        this.funcCache = [];\n        this.isBlurVerify = obj.isBlurVerify || false;\n        this.succeed = succeed = obj.succeed || null;\n        this.failure = failure = obj.failure || null;\n    };\n\n    Validator.prototype.add = function (dom, rules) {\n        var self = this;\n\n        for (var i = 0, rule; rule = rules[i++];) {\n\n            (function (rule) {\n\n                // 生成校验函数\n                var verifyFunc = function () {\n                    var strategAry = rule.strategy.split(':'),\n                        strategy = strategAry.shift();  // 取出规则名\n\n                    strategAry.unshift(dom.value);  // 放入元素的值\n                    if (strategy !== 'serverVerify') {\n                        strategAry.push(rule.errorMsg);  // 放入错误信息\n                    } else {\n                        strategAry.push(rule.requestFunc);  // 放入错误信息\n                    }\n                    return strategies[strategy].apply(dom, strategAry);\n                };\n\n                // 校验函数推入方法栈\n                if (self.isBlurVerify) {\n                    eventFunc.push(verifyFunc);\n                }\n                self.funcCache.push(verifyFunc);\n            }(rule));\n        }\n\n        // 添加blur方法\n        if (self.isBlurVerify) {\n            dom.addEventListener('blur',abc, false);\n\n            // 推入被绑定blur的元素栈\n            self.domCache.push(dom);\n        }\n    };\n\n    Validator.prototype.start = function () {\n        verifyStart = true;\n        if (this.isBlurVerify) {\n            for (var i = 0, dom; dom = this.domCache[i++];) {\n                this._trigger(dom);\n                if (!verifyStart) {\n                    return false;\n                }\n            }\n            return true;\n        } else {\n            for (var i = 0, validatorFunc; validatorFunc = this.funcCache[i++];) {\n                var errorMsg = validatorFunc();\n                if (errorMsg) {\n                    return errorMsg;\n                }\n            }\n        }\n    };\n\n    Validator.prototype.destroy=function(){\n        var self=this;\n        self.domCache.forEach(function(obj){\n            console.log(obj);\n            obj.removeEventListener('blur',abc,false);\n        });\n    };\n\n    Validator.prototype._inArray = function (needle, array) {\n        for (var i in array) {\n            if (needle === array[i]) {\n                return true;\n            }\n        }\n        return false;\n    };\n\n    Validator.prototype._trigger = function (obj) {\n        var event = document.createEvent('MouseEvents');\n        event.initMouseEvent('blur', true, true, document.defaultView, 0, 0, 0, 0, 0, false, false, false, false, 0, null);\n        obj.dispatchEvent(event);\n    };\n\n    function abc(){\n        for (var i = 0, func; func = eventFunc[i++];) {\n            if (func()) {\n                verifyStart = false;\n                return false;\n            }\n        }\n    }\n    return Validator;\n});"]}